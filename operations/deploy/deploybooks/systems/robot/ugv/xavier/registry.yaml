# //////////////////////////////////////////////////////////////////////////////
- docker:
# //////////////////////////////////////////////////////////////////////////////

  # ////////////////////////////////////////////////////////////////////////////
  - registry:
  # ////////////////////////////////////////////////////////////////////////////

    # //////////////////////////////////////////////////////////////////////////
    - azure:
    # //////////////////////////////////////////////////////////////////////////

      # pull images from the docker registry
      - pull:
        # change the docker context to the ugv azure docker daemon
        - docker context use $DOCKER_CONTEXT
        - docker images
        # pull the docker images from the laptop local registry
        - docker pull $AZURE_REGISTRY/subt/chonky_l4t
        - docker pull $AZURE_REGISTRY/subt/perception-arm:ros
        - docker pull $AZURE_REGISTRY/subt/perception-arm:0.1
        # tag the docker images
        - docker tag $AZURE_REGISTRY/subt/chonky_l4t subt/chonky_l4t
        - docker tag $AZURE_REGISTRY/subt/perception-arm:ros subt/perception-arm:ros
        - docker tag $AZURE_REGISTRY/subt/perception-arm:0.1 subt/perception-arm:0.1
        # remove the azure docker images
        - docker rmi $AZURE_REGISTRY/subt/chonky_l4t
        - docker rmi $AZURE_REGISTRY/subt/perception-arm:ros
        - docker rmi $AZURE_REGISTRY/subt/perception-arm:0.1
        - docker rmi $(docker images | grep $AZURE_REGISTRY | tr -s ' ' | cut -d ' ' -f 1)
        # show the docker images
        - docker images
        # change the docker context back to the default docker daemon
        - docker context use default

    # //////////////////////////////////////////////////////////////////////////
    - basestation:
    # //////////////////////////////////////////////////////////////////////////
      

      # pull images from the docker registry
      - pull:
        # change the docker context to the ugv azure docker daemon
        - docker context use default
        - docker images
        # tag the docker images on the basestation registry
        - docker tag subt/chonky_l4t $BASESTATION_REGISTRY/subt/chonky_l4t
        - docker tag subt/perception-arm:ros $BASESTATION_REGISTRY/subt/perception-arm:ros
        - docker tag subt/perception-arm:0.1 $BASESTATION_REGISTRY/subt/perception-arm:0.1
        # change the docker context to the ugv xavier robot docker daemon
        - docker context use $DOCKER_CONTEXT
        # pull the docker images from the laptop local registry
        - docker pull $BASESTATION_REGISTRY/subt/chonky_l4t
        - docker pull $BASESTATION_REGISTRY/subt/perception-arm:ros
        - docker pull $BASESTATION_REGISTRY/subt/perception-arm:0.1
        # tag the docker images
        - docker tag $BASESTATION_REGISTRY/subt/chonky_l4t subt/chonky_l4t 
        - docker tag $BASESTATION_REGISTRY/subt/perception-arm:ros subt/perception-arm:ros
        - docker tag $BASESTATION_REGISTRY/subt/perception-arm:0.1 subt/perception-arm:0.1
        # remove the basestation docker images
        - docker rmi $(docker images | grep $BASESTATION_REGISTRY | tr -s ' ' | cut -d ' ' -f 1)
        # show the docker images
        - docker images
        # change the docker context back to the default docker daemon
        - docker context use default
        # remove the basestation docker images:
        - docker rmi $(docker images | grep $BASESTATION_REGISTRY | tr -s ' ' | cut -d ' ' -f 1)

    
