# //////////////////////////////////////////////////////////////////////////////
# @brief Azure basestation deployment
- azure:
# //////////////////////////////////////////////////////////////////////////////

  # source the top-level scenario files
  - source operations/deploy/scenarios/.base.env
  - source operations/deploy/scenarios/systems/azure/.azure.env

  # ////////////////////////////////////////////////////////////////////////////
  # @brief basestation general deployment
  - basestation:
  # ////////////////////////////////////////////////////////////////////////////

    # azure registry
    - +extend: systems/azure/basestation/vm/registry

    # source the computer-level scenario file
    - export filename=systems/azure/basestation-cpu
    - source operations/deploy/scenarios/$filename.env
    - export scenario=" --scenario $filename"
    - vm:
      - +extend: common/transfer
      - +extend: common/skel_t
      - teamviewer:
        - +ssh:{ azure.basestation }
        - sudo teamviewer info | grep " ID:"

  # ////////////////////////////////////////////////////////////////////////////
  # @brief basestation GUI deployment
  - basestation.cpu:
  # ////////////////////////////////////////////////////////////////////////////

    # source the computer-level scenario file
    - export filename=systems/azure/basestation-cpu
    - source operations/deploy/scenarios/$filename.env
    - export scenario=" --scenario $filename"

    - vm:
      - git:
        - +ssh:{ azure.basestation }
      - compose:
        - +ssh:{ azure.basestation }
        - +extend: systems/azure/basestation/vm/compose
      - catkin:
        - +ssh:{ azure.basestation }
        - +docker:basestation-cpu-shell
        - +extend: systems/azure/basestation/vm/catkin

  # ////////////////////////////////////////////////////////////////////////////
  # @brief basestation perception deployment
  - basestation.gpu:
  # ////////////////////////////////////////////////////////////////////////////

    # source the computer-level scenario file
    - export filename=systems/azure/basestation-gpu
    - source operations/deploy/scenarios/$filename.env
    - export scenario=" --scenario $filename"

    - vm:
      - git:
        - +ssh:{ azure.basestation }
      - compose:
        - +ssh:{ azure.basestation }
        - +extend: systems/azure/basestation/vm/compose
      - catkin:
        - +ssh:{ azure.basestation }
        - +docker:basestation-gpu-shell
        - +extend: systems/azure/basestation/vm/catkin

