- pwd
- 'export SRC_DIR=$PWD'

###################################################################################################
- sudo chown -R jenkins:jenkins /home/developer/ros_osrf/

- clone:
  - 'echo "Cloning planning_ws"'
  - git submodule update perception/object_detection
  - rosdep update
  
- build:
  - 'echo "Building planning_ws"'

  # build the workspace deps
  - deps:
    - cd $SRC_DIR/perception/deps/catkin/
    - rosdep install --from-paths . --ignore-src --rosdistro melodic -y
    - catkin config --extend /home/developer/ros_osrf/devel
    - catkin build --no-status

  # build the workspace
  - ws:
    - cd $SRC_DIR/perception/
    - rosdep install --from-paths . --ignore-src --rosdistro melodic -y
    - catkin build --no-status

###################################################################################################
- test:
  - cd $SRC_DIR/perception/object_detection/inference/scripts
  - python test_multi_object_detector.py 

###################################################################################################
- clean:
  # clean workspace
  - ws:
    - cd $SRC_DIR/perception/
    - catkin clean -y
  # clean workspace deps
  - deps:
    - cd $SRC_DIR/perception/deps/catkin/
    - catkin clean -y

